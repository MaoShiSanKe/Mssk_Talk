<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>留言给我</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500&family=Noto+Sans+SC:wght@300;400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/main.css">
</head>
<body>

  <!-- 漂浮留言墙背景层（showFeatured 开启时显示） -->
<div id="bubble-layer" style="display:none"></div>

<header>
    <h1 data-i18n="site.title">留言给我</h1>
    <p data-i18n="site.description">你的消息会以匿名方式送达，联系方式完全可选。</p>
  </header>

  <!-- 置顶消息（showPinned 开启且有置顶内容时显示） -->
  <div id="pinned-section" style="display:none;width:100%;max-width:560px;margin-bottom:8px;position:relative;z-index:1;">
    <button id="pinned-toggle" class="pinned-toggle">置顶消息 ▾</button>
    <div id="pinned-list" class="pinned-list" style="display:none"></div>
  </div>

  <div class="card">
    <form id="message-form" autocomplete="off">
      <!-- Honeypot：人不会看到，机器人会填，服务端检测到有值则拦截 -->
      <input type="text" id="_hp" name="_hp" aria-hidden="true" tabindex="-1" autocomplete="off"
        style="position:fixed;top:-9999px;left:-9999px;width:1px;height:1px;opacity:0;pointer-events:none;">
      <div class="form-group">
        <textarea
          id="message-content"
          data-i18n-attr="placeholder"
          data-i18n="form.message_placeholder"
          placeholder="写下你想说的话……"
        ></textarea>
        <div class="char-count"><span id="char-count">0 / 2000</span></div>
      </div>

      <div class="divider"><span>可选信息</span></div>

      <div class="form-group">
        <label data-i18n="form.image_url_label">图片链接（可选）</label>
        <input
          type="url"
          id="image-url"
          data-i18n-attr="placeholder"
          data-i18n="form.image_url_placeholder"
          placeholder="https://your-image-host.com/image.jpg"
        >
        <p class="tip">请先将图片上传至图床（如 <a href="https://imgur.com" target="_blank" rel="noopener" class="tip-link">Imgur</a>、<a href="https://imgbb.com" target="_blank" rel="noopener" class="tip-link">ImgBB</a>），再粘贴链接</p>
      </div>

      <div class="form-group" id="contact-group">
        <label id="contact-label" data-i18n="form.contact_label">联系方式（可选）</label>
        <input
          type="text"
          id="contact"
          data-i18n-attr="placeholder"
          data-i18n="form.contact_placeholder"
          placeholder="邮箱、Twitter、微博……随你填"
        >
      </div>

      <button type="submit" class="submit-btn" id="submit-btn" data-i18n="form.submit">
        发送消息
      </button>
    </form>

    <div id="feedback" class="feedback hidden"></div>

    <div class="history-section" id="history-section" style="display:none">
      <button class="history-toggle" id="history-toggle" data-i18n="history.toggle_show">
        查看历史记录
      </button>
      <div id="history-list"></div>
    </div>
  </div>

  <footer style="text-align:center;padding:32px 16px 16px;font-size:0.78rem;display:flex;align-items:center;justify-content:center;gap:16px;">
    <a href="https://github.com/MaoShiSanKe/Mssk_Talk" target="_blank" rel="noopener"
      style="color:var(--text-secondary);text-decoration:none;">Mssk_Talk on GitHub</a>
    <button id="lang-toggle" style="background:none;border:none;cursor:pointer;font-size:0.78rem;color:var(--text-secondary);padding:0;font-family:inherit;" title="Switch language">EN</button>
    <button class="theme-toggle" style="background:none;border:none;cursor:pointer;font-size:1rem;padding:0;" title="切换主题">🌙</button>
  </footer>

  <script src="./js/theme.js"></script>
  <script src="./js/config.js"></script>
  <script src="./js/i18n.js"></script>
  <script src="./js/supabase.js"></script>
  <script src="./js/visitor.js"></script>
  <script src="./js/bubbles.js"></script>
  <script src="./js/main.js"></script>
</body>
</html>